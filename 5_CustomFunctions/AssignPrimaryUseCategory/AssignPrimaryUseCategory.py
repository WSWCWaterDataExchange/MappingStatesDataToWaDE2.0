# Last Update: 08/01/2022
# Dependents: AllocationsAmounts_fact.py
# Purpose: To assign a single value to the PrimaryUseCategory field for water rights.
# Notes 1) The BUtoWBUDict dictionary for converting Native Beneficial Use -> WaDE Beneficial Use will have to be updated everytime there is a native new benefical use added to the QA.


# Needed Libraries
############################################################################
import os
import numpy as np
import pandas as pd


# Dictionaries
############################################################################
# Native Beneficial Use -> WaDE Beneficial Use
BUtoWBUDict = {
"" : "Unspecified",
"agricultural" : "Agriculture Irrigation",
"agricultural consumptive use" : "Agriculture Irrigation",
"agricultural spraying" : "Agriculture Irrigation",
"agriculture" : "Agriculture Irrigation",
"agriculture - wetland" : "Agriculture Irrigation",
"agriculture other than irrigation" : "Agriculture Irrigation",
"agriculture uses" : "Agriculture Irrigation",
"cranberry" : "Agriculture Irrigation",
"harvesting of cranberries" : "Agriculture Irrigation",
"irrigated agriculture" : "Agriculture Irrigation",
"irrigation" : "Agriculture Irrigation",
"irrigation - ground water" : "Agriculture Irrigation",
"irrigation - surface water" : "Agriculture Irrigation",
"irrigation and domestic" : "Agriculture Irrigation",
"irrigation and incidental underground storage" : "Agriculture Irrigation",
"irrigation and storage (an appropriation approved for both uses)" : "Agriculture Irrigation",
"irrigation from natural stream" : "Agriculture Irrigation",
"irrigation from storage" : "Agriculture Irrigation",
"irrigation of cranberries" : "Agriculture Irrigation",
"irrigation-carey act" : "Agriculture Irrigation",
"irrigation-dle" : "Agriculture Irrigation",
"nursery uses" : "Agriculture Irrigation",
"practicably irrigable acreage" : "Agriculture Irrigation",
"primary and supplemental irrigation" : "Agriculture Irrigation",
"subirrigation" : "Agriculture Irrigation",
"supplemental irrigation" : "Agriculture Irrigation",
"supplemental irrigation and incidental underground storage" : "Agriculture Irrigation",
"aquaculture" : "Aquaculture",
"cultivation of fish" : "Aquaculture",
"fish culture" : "Aquaculture",
"fish habitat" : "Aquaculture",
"fish habitat storage" : "Aquaculture",
"fish propagation" : "Aquaculture",
"fish propagation from storage" : "Aquaculture",
"fish propagation storage" : "Aquaculture",
"fish raceways" : "Aquaculture",
"fishery" : "Aquaculture",
"instream fishery" : "Aquaculture",
"other (fish hatchery)" : "Aquaculture",
"supplemental fish culture" : "Aquaculture",
"aquifer recharge" : "Aquifer Recharge",
"ground water recharge" : "Aquifer Recharge",
"ground water recharge from storage" : "Aquifer Recharge",
"ground water recharge storage" : "Aquifer Recharge",
"ground water remediation" : "Aquifer Recharge",
"groundwater aquifer storage & recovery" : "Aquifer Recharge",
"groundwater preservation" : "Aquifer Recharge",
"groundwater recharge" : "Aquifer Recharge",
"incidental underground storage" : "Aquifer Recharge",
"induced ground water recharge" : "Aquifer Recharge",
"injection" : "Aquifer Recharge",
"intentional underground storage" : "Aquifer Recharge",
"marketing for mitigation/aquifer recharge" : "Aquifer Recharge",
"monitor" : "Aquifer Recharge",
"monitoring well" : "Aquifer Recharge",
"observation" : "Aquifer Recharge",
"observation and testing" : "Aquifer Recharge",
"recharge" : "Aquifer Recharge",
"storage and incidental underground storage" : "Aquifer Recharge",
"72-12-1 construction of public works" : "Commercial/Industrial",
"72-12-1 sanitary in conjunction with a commercial use" : "Commercial/Industrial",
"air conditioning" : "Commercial/Industrial",
"bottling" : "Commercial/Industrial",
"brine production well" : "Commercial/Industrial",
"chemical" : "Commercial/Industrial",
"commercial" : "Commercial/Industrial",
"commercial (self-supplied)" : "Commercial/Industrial",
"commercial & indust" : "Commercial/Industrial",
"commercial from storage" : "Commercial/Industrial",
"commercial institutional" : "Commercial/Industrial",
"commercial storage" : "Commercial/Industrial",
"commercial uses" : "Commercial/Industrial",
"construction" : "Commercial/Industrial",
"highway" : "Commercial/Industrial",
"highway construction" : "Commercial/Industrial",
"industrial" : "Commercial/Industrial",
"industrial - ground water" : "Commercial/Industrial",
"industrial - power generation" : "Commercial/Industrial",
"industrial - salt water" : "Commercial/Industrial",
"industrial - surface water" : "Commercial/Industrial",
"industrial (self-supplied)" : "Commercial/Industrial",
"industrial cooling" : "Commercial/Industrial",
"industrial from storage" : "Commercial/Industrial",
"industrial storage" : "Commercial/Industrial",
"industrial use" : "Commercial/Industrial",
"industrial/manufacturing uses" : "Commercial/Industrial",
"laboratory" : "Commercial/Industrial",
"log deck sprinkling" : "Commercial/Industrial",
"manufacturing" : "Commercial/Industrial",
"meat packing plant" : "Commercial/Industrial",
"mechanical" : "Commercial/Industrial",
"medicinal" : "Commercial/Industrial",
"military - military installations" : "Commercial/Industrial",
"oil" : "Commercial/Industrial",
"oil field maintenance" : "Commercial/Industrial",
"oil production" : "Commercial/Industrial",
"oil well flooding" : "Commercial/Industrial",
"petroleum processing plant" : "Commercial/Industrial",
"poultry and egg operation" : "Commercial/Industrial",
"railroad" : "Commercial/Industrial",
"railway" : "Commercial/Industrial",
"ram" : "Commercial/Industrial",
"road construction" : "Commercial/Industrial",
"sale" : "Commercial/Industrial",
"sawmill" : "Commercial/Industrial",
"secondary recovery of oil" : "Commercial/Industrial",
"shop" : "Commercial/Industrial",
"transportation" : "Commercial/Industrial",
"72-12-1 domestic and livestock watering" : "Domestic",
"72-12-1 domestic one household" : "Domestic",
"72-12-1 multiple domestic households" : "Domestic",
"dcii" : "Domestic",
"domestic" : "Domestic",
"domestic - ground water" : "Domestic",
"domestic - surface water" : "Domestic",
"domestic (self-supplied)" : "Domestic",
"domestic and livestock" : "Domestic",
"domestic and livestock & livestock" : "Domestic",
"domestic construction" : "Domestic",
"domestic expanded" : "Domestic",
"domestic from storage" : "Domestic",
"domestic general" : "Domestic",
"domestic including lawn and garden" : "Domestic",
"domestic multiple" : "Domestic",
"domestic single" : "Domestic",
"domestic storage" : "Domestic",
"domestic supply" : "Domestic",
"domestic use" : "Domestic",
"group domestic" : "Domestic",
"household use only" : "Domestic",
"human consumption" : "Domestic",
"human consumption and livestock" : "Domestic",
"mobile home parks" : "Domestic",
"multiple domestic" : "Domestic",
"multiple purpose" : "Domestic",
"multiple use" : "Domestic",
"municipal/domestic and livestock" : "Domestic",
"non 72-12-1 domestic and livestock watering" : "Domestic",
"non 72-12-1 domestic one household" : "Domestic",
"non 72-12-1 multiple domestic households" : "Domestic",
"restroom" : "Domestic",
"fire" : "Fire",
"fire protection" : "Fire",
"fire protection from storage" : "Fire",
"fire protection storage" : "Fire",
"geo-thermal (heating & cooling)" : "Geothermal",
"geo-thermal(energy production)" : "Geothermal",
"geothermal" : "Geothermal",
"geothermal boreholes" : "Geothermal",
"geothermal heating" : "Geothermal",
"hydroelectric" : "Hydroelectric",
"hydroelectric - priority" : "Hydroelectric",
"hydropower" : "Hydroelectric",
"power" : "Hydroelectric",
"power (fossil-fuel)" : "Hydroelectric",
"power (hydro-elec)" : "Hydroelectric",
"power (self-supplied)" : "Hydroelectric",
"power and incidental underground storage" : "Hydroelectric",
"power development" : "Hydroelectric",
"power from storage" : "Hydroelectric",
"power generation" : "Hydroelectric",
"power storage" : "Hydroelectric",
"raise dam (for increase in head for power production)" : "Hydroelectric",
"supplemental power" : "Hydroelectric",
"supplemental power and incidental underground storage" : "Hydroelectric",
"anadromous and resident fish habitat (instream)" : "In-stream Flow",
"aquatic life (instream)" : "In-stream Flow",
"bed and banks" : "In-stream Flow",
"consumptive instream flow" : "In-stream Flow",
"cumulative accretion to river" : "In-stream Flow",
"fire protection (instream)" : "In-stream Flow",
"fish & wildlife" : "In-stream Flow",
"fish and game propogation" : "In-stream Flow",
"fish and wildlife" : "In-stream Flow",
"fish and wildlife preservation and enhancement" : "In-stream Flow",
"fish and wildlife propagation" : "In-stream Flow",
"fishery enhancement (instream)" : "In-stream Flow",
"instream" : "In-stream Flow",
"instream flow" : "In-stream Flow",
"instream flow requirements" : "In-stream Flow",
"irrigation storage" : "In-stream Flow",
"lake level maintenance" : "In-stream Flow",
"managed wetlands" : "In-stream Flow",
"minimum stream flow" : "In-stream Flow",
"minimum streamflow" : "In-stream Flow",
"multiple instream uses" : "In-stream Flow",
"required delta outflow" : "In-stream Flow",
"riparian habitat (instream)" : "In-stream Flow",
"riparian habitat restoration project" : "In-stream Flow",
"stream" : "In-stream Flow",
"stream augmentation" : "In-stream Flow",
"streamflow maintenance from storage" : "In-stream Flow",
"wild and scenic river" : "In-stream Flow",
"wildlife" : "In-stream Flow",
"wildlife/waterfowl" : "In-stream Flow",
"72-12-1 livestock watering" : "Livestock",
"dairy" : "Livestock",
"dairy barn uses" : "Livestock",
"dairy operation" : "Livestock",
"feed pen operation" : "Livestock",
"livestock" : "Livestock",
"livestock (self-supplied)" : "Livestock",
"non 72-12-1 livestock watering" : "Livestock",
"stock" : "Livestock",
"stock and domestic" : "Livestock",
"stock water" : "Livestock",
"stock watering" : "Livestock",
"stockpond" : "Livestock",
"stockraising" : "Livestock",
"stockwater" : "Livestock",
"stockwater from storage" : "Livestock",
"stockwater storage" : "Livestock",
"stockwatering" : "Livestock",
"coal bed methane - ground water" : "Mining",
"coal bed natural gas" : "Mining",
"milling" : "Mining",
"minerals" : "Mining",
"mining" : "Mining",
"mining (self-supplied)" : "Mining",
"mining and milling" : "Mining",
"mining from storage" : "Mining",
"mining milling and dewatering" : "Mining",
"mining or milling or oil" : "Mining",
"mining storage" : "Mining",
"aesthetic" : "Municipal Irrigation",
"aesthetic from storage" : "Municipal Irrigation",
"aesthetic storage" : "Municipal Irrigation",
"aesthetics" : "Municipal Irrigation",
"cemetery" : "Municipal Irrigation",
"institution" : "Municipal Irrigation",
"institutional" : "Municipal Irrigation",
"landscape irrigation" : "Municipal Irrigation",
"lawn and garden" : "Municipal Irrigation",
"municipal storage" : "Municipal Irrigation",
"municipal/industrial" : "Municipal Irrigation",
"pond maintenance" : "Municipal Irrigation",
"public parks" : "Municipal Irrigation",
"public supply" : "Municipal Irrigation",
"public utility" : "Municipal Irrigation",
"school use" : "Municipal Irrigation",
"0 release for enviroment" : "Other",
"72-12-1 prospecting or development of natural resource" : "Other",
"administrative" : "Other",
"dewatering" : "Other",
"dewatering well" : "Other",
"discharge" : "Other",
"diversion out of basin" : "Other",
"divtotal" : "Other",
"dust control" : "Other",
"environmental" : "Other",
"environmental quality" : "Other",
"erosion control" : "Other",
"evaporation" : "Other",
"evaporative" : "Other",
"exploration" : "Other",
"export from basin" : "Other",
"export from state" : "Other",
"exports/imports" : "Other",
"federal reserved" : "Other",
"federal reserved use" : "Other",
"flood control" : "Other",
"flood control permit" : "Other",
"flood control storage" : "Other",
"flow augmentation" : "Other",
"flow through" : "Other",
"flow through fish pond" : "Other",
"forest management" : "Other",
"frost protection" : "Other",
"game preserves" : "Other",
"greenhouse" : "Other",
"ice cutting" : "Other",
"indian" : "Other",
"mitigation" : "Other",
"mitigation by non-use" : "Other",
"mitigation water" : "Other",
"multi use" : "Other",
"navigation" : "Other",
"non consumptive" : "Other",
"non-consumptive" : "Other",
"non-profit organizational use" : "Other",
"nonconsumptive" : "Other",
"other" : "Other",
"other purpose" : "Other",
"other pws" : "Other",
"other spillway/floodgat" : "Other",
"pollution abatement" : "Other",
"pollution abatement (instream)" : "Other",
"pollution control well" : "Other",
"sediment control" : "Other",
"stage" : "Other",
"supplemental flood harvesting" : "Other",
"temporary" : "Other",
"temporary transfer to in-stream use" : "Other",
"transmountain export" : "Other",
"unused" : "Other",
"water marketing" : "Other",
"water quality" : "Other",
"water quality improvement" : "Other",
"water quality improvement from storage" : "Other",
"water quality improvement storage" : "Other",
"waterfowl" : "Other",
"wetland" : "Other",
"wetland mitigation credit" : "Other",
"wetlands" : "Other",
"wildlife from storage" : "Other",
"wildlife habitat" : "Other",
"wildlife habitat maintenance and enhancement" : "Other",
"wildlife management" : "Other",
"wildlife refuge" : "Other",
"wildlife storage" : "Other",
"quasi-municipal" : "Public Supply",
"quasi-municipal uses" : "Public Supply",
"public water supply" : "Public Supply",
"community type use" : "Public Supply",
"m & i" : "Public Supply",
"multi family residential" : "Public Supply",
"municipal" : "Public Supply",
"municipal - city or county supplied water" : "Public Supply",
"municipal - ground water" : "Public Supply",
"municipal - surface water" : "Public Supply",
"municipal from storage" : "Public Supply",
"municipal use" : "Public Supply",
"municipal uses" : "Public Supply",
"potable supply" : "Public Supply",
"rural water" : "Public Supply",
"rural water system" : "Public Supply",
"single family residential" : "Public Supply",
"subdivision" : "Public Supply",
"suburban housing development" : "Public Supply",
"urban" : "Public Supply",
"use in a mint still" : "Public Supply",
"use within a school" : "Public Supply",
"water supplier" : "Public Supply",
"campsite" : "Recreation",
"maintain level of a lake" : "Recreation",
"recreation" : "Recreation",
"recreation - beautification" : "Recreation",
"recreation fish wildlife" : "Recreation",
"recreation from storage" : "Recreation",
"recreation storage" : "Recreation",
"recreational" : "Recreation",
"swimming" : "Recreation",
"reservoir evaporation" : "Reservoir Storage",
"3 storage" : "Reservoir Storage",
"diversion to storage" : "Reservoir Storage",
"major and minor reservoirs" : "Reservoir Storage",
"reservoir supply" : "Reservoir Storage",
"storage" : "Reservoir Storage",
"storage use-only" : "Reservoir Storage",
"strategic water reserve" : "Reservoir Storage",
"streamflow maintenance storage" : "Reservoir Storage",
"supplemental storage" : "Reservoir Storage",
"snow making" : "Snow",
"air conditioning or heating" : "Thermoelectric Cooling",
"cooling" : "Thermoelectric Cooling",
"cooling for indust proces" : "Thermoelectric Cooling",
"cooling from storage" : "Thermoelectric Cooling",
"cooling storage" : "Thermoelectric Cooling",
"heat control" : "Thermoelectric Cooling",
"heat exchange" : "Thermoelectric Cooling",
"heat protection for crops" : "Thermoelectric Cooling",
"heating" : "Thermoelectric Cooling",
"supplemental cooling" : "Thermoelectric Cooling",
"temperature control" : "Thermoelectric Cooling",
"reuse" : "Treated Wastewater/Reuse",
"sewage treatment" : "Treated Wastewater/Reuse",
"waste storage" : "Treated Wastewater/Reuse",
"all beneficial uses" : "Unspecified",
"any purpose" : "Unspecified",
"as decreed" : "Unspecified",
"augmentation" : "Unspecified",
"augmentation well" : "Unspecified",
"cathodic protection well" : "Unspecified",
"closed file" : "Unspecified",
"combined uses" : "Unspecified",
"incidental power" : "Unspecified",
"miscellaneous - ground water" : "Unspecified",
"no purpose identified" : "Unspecified",
"no right" : "Unspecified",
"no use of right or pod" : "Unspecified",
"none" : "Unspecified",
"not classified" : "Unspecified",
"stacked water right" : "Unspecified",
"to be determined" : "Unspecified",
"total" : "Unspecified",
"undefined" : "Unspecified",
"undetermined" : "Unspecified",
"unknown" : "Unspecified",
"unspecified" : "Unspecified"}


# WaDE Convert Multi-Beneficial Use to Single Primary Use Dictionary
# This has been built looking for unique items of only length = 2
WaDEBenUseDict = {
"Agriculture Irrigation,Aquaculture" : "Agriculture Irrigation",
"Agriculture Irrigation,Commercial/Industrial" : "Agriculture Irrigation",
"Agriculture Irrigation,Domestic" : "Agriculture Irrigation",
"Agriculture Irrigation,Livestock" : "Agriculture Irrigation",
"Agriculture Irrigation,Other" : "Agriculture Irrigation",
"Agriculture Irrigation,Public Supply" : "Agriculture Irrigation",
"Agriculture Irrigation,Recreation" : "Agriculture Irrigation",
"Agriculture Irrigation,Unspecified" : "Agriculture Irrigation",
"Aquaculture,Recreation" : "Recreation",
"Commercial/Industrial,Domestic" : "Commercial/Industrial",
"Commercial/Industrial,Livestock" : "Commercial/Industrial",
"Domestic,Fire" : "Domestic",
"Domestic,Livestock" : "Livestock",
"Domestic,Municipal Irrigation" : "Municipal Irrigation",
"Domestic,Other" : "Domestic",
"Domestic,Public Supply" : "Public Supply",
"Domestic,Unspecified" : "Domestic",
"Fire,Livestock" : "Livestock",
"In-stream Flow,Unspecified" : "In-stream Flow",
"Livestock,Municipal Irrigation" : "Municipal Irrigation",
"Livestock,Other" : "Livestock",
"Livestock,Unspecified" : "Livestock",
"Public Supply,Unspecified" : "Public Supply",
"Reservoir Storage,Unspecified" : "Reservoir Storage"}




# Function
############################################################################
def retrievePrimaryUseCategory(val):
    # Clean val & create list.
    valList = val.split(",")
    valList = sorted(list(map(lambda x: str(x).strip().lower(), valList)))

    # Temp converting native ben use to WaDE terminology ben use
    # Using get() to retrieve items from dictionary for list
    wbuList = sorted(list(map(lambda x: BUtoWBUDict[x], valList)))

    # Assign PrimaryUse
    # if len = 2, use dictionary
    # if not, return first item in list as string
    if len(wbuList) == 2:
        try:
            outString = WaDEBenUseDict[",".join(str(x) for x in wbuList)]
        except:
            outString = wbuList[0]
    else:
        outString = wbuList[0]
        outString = str(outString).strip()

    return outString