# Last Update: 05/06/2022
# Dependents: AllocationsAmounts_fact.py
# Purpose: To assign a single value to the PrimaryUseCategory field for water rights.
# Notes 1) The BUtoWBUDict dictionary for converting Native Beneficial Use -> WaDE Beneficial Use will have to be updated everytime there is a native new benefical use added to the QA.


# Needed Libraries
############################################################################
import os
import numpy as np
import pandas as pd


# Dictionaries
############################################################################
# Native Beneficial Use -> WaDE Beneficial Use
BUtoWBUDict = {
"72-12-1 Sanitary in conjunction with a commercial use" : "Commercial/Industrial",
"Administrative" : "Other",
"Aesthetic" : "Municipal Irrigation",
"Aesthetic From Storage" : "Municipal Irrigation",
"Aesthetic Storage" : "Municipal Irrigation",
"Aesthetics" : "Municipal Irrigation",
"Agricultural" : "Agriculture Irrigation",
"Agricultural Consumptive Use" : "Agriculture Irrigation",
"Agricultural Spraying" : "Agriculture Irrigation",
"Agriculture" : "Agriculture Irrigation",
"AGRICULTURE - WETLAND" : "Agriculture Irrigation",
"Agriculture other than irrigation" : "Agriculture Irrigation",
"Agriculture Uses" : "Agriculture Irrigation",
"AIR CONDITIONING" : "Other",
"Air Conditioning or Heating" : "Thermoelectric Cooling",
"All Beneficial Uses" : "Unspecified",
"Anadromous and Resident Fish Habitat (Instream)" : "In-stream Flow",
"Any Purpose" : "Unspecified",
"Aquaculture" : "Aquaculture",
"AQUATIC LIFE (INSTREAM)" : "In-stream Flow",
"Aquifer Recharge" : "Aquifer Recharge",
"As Decreed" : "Unspecified",
"Augmentation" : "Unspecified",
"BED AND BANKS" : "In-stream Flow",
"BOTTLING" : "Commercial/Industrial",
"Campsite" : "Recreation",
"Chemical" : "Commercial/Industrial",
"Closed file" : "Unspecified",
"Coal Bed Methane - Ground Water" : "Mining",
"Combined Uses" : "Unspecified",
"Commercial" : "Commercial/Industrial",
"Commercial & indust" : "Commercial/Industrial",
"Commercial (self-supplied)" : "Commercial/Industrial",
"Commercial From Storage" : "Commercial/Industrial",
"Commercial Institutional" : "Commercial/Industrial",
"Commercial Storage" : "Commercial/Industrial",
"Commercial Uses" : "Commercial/Industrial",
"Community type use" : "Public Supply",
"Construction" : "Commercial/Industrial",
"Consumptive Instream Flow" : "In-stream Flow",
"Cooling" : "Thermoelectric Cooling",
"Cooling for indust proces" : "Thermoelectric Cooling",
"Cooling From Storage" : "Thermoelectric Cooling",
"Cooling Storage" : "Thermoelectric Cooling",
"Cranberry" : "Agriculture Irrigation",
"Cumulative Accretion To River" : "In-stream Flow",
"Dairy" : "Livestock",
"Dairy Barn Uses" : "Livestock",
"Dairy operation" : "Livestock",
"DCII" : "Other",
"Dewatering" : "Other",
"Dewatering well" : "Other",
"Discharge" : "Other",
"Diversion To Storage" : "Reservoir Storage",
"DivTotal" : "Other",
"Domestic" : "Domestic",
"Domestic - Ground Water" : "Domestic",
"Domestic - Surface Water" : "Domestic",
"Domestic (self-supplied)" : "Domestic",
"Domestic and Livestock" : "Domestic",
"DOMESTIC AND LIVESTOCK & LIVESTOCK" : "Domestic",
"Domestic construction" : "Domestic",
"Domestic Expanded" : "Domestic",
"Domestic From Storage" : "Domestic",
"Domestic general" : "Domestic",
"Domestic Including Lawn and Garden" : "Domestic",
"Domestic multiple" : "Domestic",
"Domestic single" : "Domestic",
"Domestic Storage" : "Domestic",
"Domestic Supply" : "Domestic",
"Domestic Use" : "Domestic",
"Dust Control" : "Other",
"Environmental" : "Other",
"Environmental quality" : "Other",
"Erosion Control" : "Other",
"Evaporation" : "Other",
"Evaporative" : "Other",
"Exploration" : "Other",
"Export From Basin" : "Other",
"Export From State" : "Other",
"Exports/Imports" : "Other",
"Federal Reserved" : "Other",
"Fire" : "Fire",
"Fire Protection" : "Fire",
"Fire Protection From Storage" : "Fire",
"Fire Protection Storage" : "Fire",
"Fish & Wildlife" : "In-stream Flow",
"Fish and game propogation" : "In-stream Flow",
"Fish And Wildlife" : "In-stream Flow",
"Fish and Wildlife Preservation and Enhancement" : "In-stream Flow",
"Fish And Wildlife Propagation" : "In-stream Flow",
"Fish Culture" : "Aquaculture",
"Fish Habitat" : "Aquaculture",
"Fish Habitat Storage" : "Aquaculture",
"Fish Propagation" : "Aquaculture",
"Fish Propagation Storage" : "Aquaculture",
"Fish Raceways" : "Aquaculture",
"Fishery" : "Aquaculture",
"Flood Control" : "Other",
"Flood Control Permit" : "Other",
"Flow Through" : "Other",
"Flow Through Fish Pond" : "Other",
"Forest Management" : "Other",
"Frost Protection" : "Other",
"GAME PRESERVES" : "Other",
"Geothermal" : "Thermoelectric Cooling",
"Geo-Thermal (Heating & Cooling)" : "Thermoelectric Cooling",
"Geothermal boreholes" : "Thermoelectric Cooling",
"Geothermal Heating" : "Thermoelectric Cooling",
"Greenhouse" : "Other",
"Ground Water Recharge" : "Aquifer Recharge",
"Ground Water Recharge From Storage" : "Aquifer Recharge",
"Ground Water Recharge Storage" : "Aquifer Recharge",
"Ground Water Remediation" : "Aquifer Recharge",
"Groundwater Preservation" : "Aquifer Recharge",
"Groundwater Recharge" : "Aquifer Recharge",
"Group Domestic" : "Domestic",
"Harvesting of Cranberries" : "Agriculture Irrigation",
"Heat Control" : "Thermoelectric Cooling",
"Heat Exchange" : "Thermoelectric Cooling",
"Heat protection for crops" : "Thermoelectric Cooling",
"Heating" : "Thermoelectric Cooling",
"Highway" : "Commercial/Industrial",
"Highway construction" : "Commercial/Industrial",
"Household Use Only" : "Domestic",
"Human Consumption" : "Domestic",
"HYDROELECTRIC" : "Hydroelectric",
"HYDROELECTRIC - PRIORITY" : "Hydroelectric",
"Hydropower" : "Hydroelectric",
"Incidental Power" : "Unspecified",
"Incidental Underground Storage" : "Aquifer Recharge",
"Indian" : "Other",
"Induced Ground Water Recharge" : "Aquifer Recharge",
"Industrial" : "Commercial/Industrial",
"Industrial - Ground Water" : "Commercial/Industrial",
"INDUSTRIAL - POWER GENERATION" : "Commercial/Industrial",
"INDUSTRIAL - SALT WATER" : "Commercial/Industrial",
"Industrial - Surface Water" : "Commercial/Industrial",
"Industrial (self-supplied)" : "Commercial/Industrial",
"INDUSTRIAL COOLING" : "Commercial/Industrial",
"Industrial From Storage" : "Commercial/Industrial",
"Industrial Storage" : "Commercial/Industrial",
"Industrial Use" : "Commercial/Industrial",
"Industrial/Manufacturing Uses" : "Commercial/Industrial",
"Injection" : "Aquifer Recharge",
"INSTITUTION" : "Municipal Irrigation",
"Institutional" : "Municipal Irrigation",
"INSTREAM" : "In-stream Flow",
"Instream Fishery" : "Aquaculture",
"Instream Flow" : "In-stream Flow",
"Instream Flow Requirements" : "In-stream Flow",
"Intentional Underground Storage" : "Aquifer Recharge",
"Irrigated Agriculture" : "Agriculture Irrigation",
"Irrigation" : "Agriculture Irrigation",
"Irrigation - Ground Water" : "Agriculture Irrigation",
"Irrigation - Surface Water" : "Agriculture Irrigation",
"Irrigation and Domestic" : "Agriculture Irrigation",
"Irrigation and Incidental Underground Storage" : "Agriculture Irrigation",
"Irrigation and Storage (an appropriation approved for both uses)" : "Agriculture Irrigation",
"Irrigation from Natural Stream" : "Agriculture Irrigation",
"Irrigation From Storage" : "Agriculture Irrigation",
"Irrigation of Cranberries" : "Agriculture Irrigation",
"Irrigation Storage" : "In-stream Flow",
"Irrigation-Carey Act" : "Agriculture Irrigation",
"Irrigation-DLE" : "Agriculture Irrigation",
"Laboratory" : "Commercial/Industrial",
"Lake Level Maintenance" : "In-stream Flow",
"Landscape Irrigation" : "Municipal Irrigation",
"Lawn And Garden" : "Municipal Irrigation",
"Livestock" : "Livestock",
"Livestock (self-supplied)" : "Livestock",
"Log Deck Sprinkling" : "Commercial/Industrial",
"M & I" : "Public Supply",
"Maintain Level of a Lake" : "Recreation",
"Major and Minor Reservoirs" : "Reservoir Storage",
"Managed Wetlands" : "In-stream Flow",
"Manufacturing" : "Commercial/Industrial",
"Marketing For Mitigation/Aquifer Recharge" : "Aquifer Recharge",
"Mechanical" : "Commercial/Industrial",
"MEDICINAL" : "Commercial/Industrial",
"Milling" : "Mining",
"Minerals" : "Mining",
"Minimum Stream Flow" : "In-stream Flow",
"Minimum Streamflow" : "In-stream Flow",
"Mining" : "Mining",
"Mining (self-supplied)" : "Mining",
"Mining and Milling" : "Mining",
"Mining From Storage" : "Mining",
"Mining Milling and Dewatering" : "Mining",
"Mining or milling or oil" : "Mining",
"Mining Storage" : "Mining",
"Miscellaneous - Ground Water" : "Aquifer Recharge",
"Mitigation" : "Other",
"MITIGATION BY NON-USE" : "Other",
"Mitigation Water" : "Other",
"Mobile home parks" : "Domestic",
"Monitoring well" : "Aquifer Recharge",
"Multi Family Residential" : "Public Supply",
"MULTI USE" : "Other",
"Multiple Domestic" : "Domestic",
"Multiple Instream Uses" : "In-stream Flow",
"Municipal" : "Public Supply",
"Municipal - city or county supplied water" : "Public Supply",
"Municipal - Ground Water" : "Public Supply",
"Municipal - Surface Water" : "Public Supply",
"Municipal From Storage" : "Public Supply",
"Municipal Storage" : "Municipal Irrigation",
"Municipal Use" : "Public Supply",
"Municipal Uses" : "Public Supply",
"MUNICIPAL/DOMESTIC AND LIVESTOCK" : "Domestic",
"Municipal/Industrial" : "Municipal Irrigation",
"Navigation" : "Other",
"No Purpose Identified" : "Unspecified",
"No right" : "Unspecified",
"No use of right or POD" : "Unspecified",
"Non 72-12-1 domestic and livestock watering" : "Domestic",
"Non 72-12-1 domestic one household" : "Domestic",
"Non 72-12-1 livestock watering" : "Livestock",
"Non 72-12-1 multiple domestic households" : "Domestic",
"NON CONSUMPTIVE" : "Other",
"NON-CONSUMPTIVE" : "Other",
"Nursery Uses" : "Agriculture Irrigation",
"Observation" : "Aquifer Recharge",
"Observation And Testing" : "Aquifer Recharge",
"Oil" : "Commercial/Industrial",
"Oil production" : "Commercial/Industrial",
"Oil Well Flooding" : "Commercial/Industrial",
"Other" : "Other",
"OTHER (FISH HATCHERY)" : "Aquaculture",
"Other Purpose" : "Other",
"Other PWS" : "Other",
"OTHER SPILLWAY/FLOODGAT" : "Other",
"Pollution Abatement" : "Other",
"Pollution control well" : "Other",
"Pond Maintenance" : "Municipal Irrigation",
"Power" : "Unspecified",
"Power (self-supplied)" : "Unspecified",
"Power and Incidental Underground Storage" : "Unspecified",
"Power Development" : "Unspecified",
"Power From Storage" : "Hydroelectric",
"Power Generation" : "Hydroelectric",
"Power Generation Nonconsumptive" : "Hydroelectric",
"Power Storage" : "Hydroelectric",
"Primary and Supplemental Irrigation" : "Agriculture Irrigation",
"PUBLIC PARKS" : "Municipal Irrigation",
"Public Supply" : "Municipal Irrigation",
"Public utility" : "Municipal Irrigation",
"Public Water Supply" : "Municipal Irrigation",
"Quasi-Municipal" : "Domestic",
"Quasi-Municipal Uses" : "Domestic",
"Railroad" : "Commercial/Industrial",
"Railway" : "Commercial/Industrial",
"Raise Dam (for increase in head for power production)" : "Hydroelectric",
"Ram" : "Commercial/Industrial",
"Recharge" : "Aquifer Recharge",
"Recreation" : "Recreation",
"Recreation - beautification" : "Recreation",
"Recreation Fish Wildlife" : "Recreation",
"Recreation From Storage" : "Recreation",
"Recreation Storage" : "Recreation",
"Recreational" : "Recreation",
"Required Delta Outflow" : "In-stream Flow",
"Reservoir Evaporation" : "Other",
"Reservoir Supply" : "Reservoir Storage",
"Restroom" : "Domestic",
"Reuse" : "Treated Wastewater/Reuse",
"Road Construction" : "Commercial/Industrial",
"Rural Water System" : "Public Supply",
"Sale" : "Commercial/Industrial",
"Sawmill" : "Commercial/Industrial",
"School use" : "Municipal Irrigation",
"Sediment Control" : "Other",
"Shop" : "Commercial/Industrial",
"Single Family Residential" : "Public Supply",
"Snow Making" : "Snow",
"Stage" : "Other",
"Stock" : "Livestock",
"Stock and Domestic" : "Livestock",
"Stock water" : "Livestock",
"Stock Watering" : "Livestock",
"Stockpond" : "Livestock",
"STOCKRAISING" : "Livestock",
"Stockwater" : "Livestock",
"Stockwater From Storage" : "Livestock",
"Stockwater Storage" : "Livestock",
"Stockwatering" : "Livestock",
"Storage" : "Reservoir Storage",
"Storage and Incidental Underground Storage" : "Aquifer Recharge",
"Storage Use-only" : "Reservoir Storage",
"Stream" : "In-stream Flow",
"Stream augmentation" : "In-stream Flow",
"Subdivision" : "Public Supply",
"Suburban Housing Development" : "Public Supply",
"Supplemental Cooling" : "Thermoelectric Cooling",
"Supplemental Fish Culture" : "Aquaculture",
"Supplemental Flood Harvesting" : "Other",
"Supplemental Irrigation" : "Agriculture Irrigation",
"Supplemental Irrigation and Incidental Underground Storage" : "Agriculture Irrigation",
"Supplemental Power" : "Hydroelectric",
"Supplemental Power and Incidental Underground Storage" : "Hydroelectric",
"Supplemental Storage" : "Reservoir Storage",
"SWIMMING" : "Recreation",
"Temperature Control" : "Thermoelectric Cooling",
"Temporary" : "Other",
"Temporary Transfer to In-Stream Use" : "Other",
"Total" : "Unspecified",
"Transmountain Export" : "Other",
"UNDETERMINED" : "Unspecified",
"Unknown" : "Unspecified",
"Unspecified" : "Unspecified",
"UNUSED" : "Other",
"Urban" : "Public Supply",
"Use in a Mint Still" : "Public Supply",
"Use Within a School" : "Public Supply",
"Waste Storage" : "Treated Wastewater/Reuse",
"Water Marketing" : "Other",
"WATER QUALITY" : "Other",
"Water Quality Improvement" : "Other",
"Water Quality Improvement Storage" : "Other",
"Waterfowl" : "Other",
"Wetland" : "Other",
"Wetland Mitigation Credit" : "Other",
"Wetlands" : "Other",
"Wild And Scenic River" : "Other",
"Wildlife" : "Other",
"Wildlife From Storage" : "Other",
"Wildlife Habitat" : "Other",
"Wildlife Habitat Maintenance And Enhancement" : "Other",
"WILDLIFE MANAGEMENT" : "Other",
"Wildlife refuge" : "Other",
"Wildlife Storage" : "Other",
"WILDLIFE/WATERFOWL" : "Other"}


# WaDE Benefical Use to Single Primary Use Dictionary
# This has been built looking for unique items of only length = 2
WaDEBenUseDict = {
"Agriculture Irrigation,Aquaculture" : "Agriculture Irrigation",
"Agriculture Irrigation,Commercial/Industrial" : "Agriculture Irrigation",
"Agriculture Irrigation,Domestic" : "Agriculture Irrigation",
"Agriculture Irrigation,Livestock" : "Agriculture Irrigation",
"Agriculture Irrigation,Other" : "Agriculture Irrigation",
"Agriculture Irrigation,Public Supply" : "Agriculture Irrigation",
"Agriculture Irrigation,Recreation" : "Agriculture Irrigation",
"Agriculture Irrigation,Unspecified" : "Agriculture Irrigation",
"Aquaculture,Recreation" : "Recreation",
"Commercial/Industrial,Domestic" : "Commercial/Industrial",
"Commercial/Industrial,Livestock" : "Commercial/Industrial",
"Domestic,Fire" : "Domestic",
"Domestic,Livestock" : "Livestock",
"Domestic,Municipal Irrigation" : "Municipal Irrigation",
"Domestic,Other" : "Domestic",
"Domestic,Public Supply" : "Public Supply",
"Domestic,Unspecified" : "Domestic",
"Fire,Livestock" : "Livestock",
"In-stream Flow,Unspecified" : "In-stream Flow",
"Livestock,Municipal Irrigation" : "Municipal Irrigation",
"Livestock,Other" : "Livestock",
"Livestock,Unspecified" : "Livestock",
"Public Supply,Unspecified" : "Public Supply",
"Reservoir Storage,Unspecified" : "Reservoir Storage"}




# Function
############################################################################
def retrievePrimaryUseCategory(val):
    # Clean val & create list.
    val = str(val).strip()
    valList = val.split(",")
    # valList = sorted(valList)

    # Temp converting native benuse to WaDE terminology benuse
    # Using get() to retrieve items from dictionary for list
    wbuList = [BUtoWBUDict.get(item, item) for item in valList]
    wbuList = sorted(wbuList)

    # Assign PrimaryUse
    # if len = 2, use dictionary
    # if not, return first item in list as string
    if len(wbuList) == 2:
        try:
            outString = WaDEBenUseDict[",".join(str(x) for x in wbuList)]
        except:
            outString = wbuList[0]
    else:
        outString = wbuList[0]
        outString = str(outString).strip()

    return outString